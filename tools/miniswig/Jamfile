SubDir TOP tools miniswig ;

if $(LEX) && $(BISON) {
    sources = [ Filter [ Wildcard *.yy *.ll *.cpp ] : parser.cpp lexer.cpp ] ;
    MINISWIG = [ Application miniswig : $(sources) ] ;
    C++Flags miniswig : -Wno-unused ;
    IncludeDir miniswig : . ;
    ExternalLibs miniswig : LEX ;

# we gotta run bison before flex
    lexer_cpp = [ SearchSource lexer.cpp ] ;
    lexer_o = [ LocateTarget $(lexer_cpp:S=.o) ] ;
    Depends lexer_o : [ LocateTarget parser.cpp : $(SUBDIR) ] ;
}

